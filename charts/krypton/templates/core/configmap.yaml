apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "krypton.name" . }}-krypton-config
  namespace: {{ include "krypton.namespace" . }}
  labels:
    {{- include "krypton.core.labels" . | nindent 4 }}
immutable: {{ .Values.config.isImmutable | default false }}
data:
  config.yaml: |-
    application:
      name: {{ .Chart.Name }}
      {{- with .Values.config.application }}
      environment: {{ .environment }}
        {{- with .labels }}
      labels:
          {{- toYaml . | nindent 8 }}
        {{- end}}
      {{- end}}

      {{- with .Values.config.krypton }}
      {{- toYaml . | nindent 4 }}
      {{- end}}
